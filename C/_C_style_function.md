
> 作者：nicer  
> 微信公众号：好好编程

函数设计
=======================================

函数返回值
--------------------------------

函数的返回值的意义可以分为以下种类：
* 函数调用结果
* 是与非
* 某个对象
* 无返回值
* 其他

**表示函数调用结果**

某一类函数是用来执行一项操作或命令，这一类函数需要返回操作的结果。
一般linux程序员的习惯是：0 表示绝对正确，负数表示错误类型。

例如：
```c
int something_init(void)
{
    if(xx) {
        return 0;       // 成功
    }
    else{
        return -1;      // 失败
    }
}
```

**是与非**

此类函数的返回值可以看成是布尔型，不是true就是false，只能两种状态。
布尔型的定义是0值代表false，其他值都为true。代码中一般用：1 表示true，0表示false。

例如：`int isdigit(int c)`
此函数用来判断参数`c`是否是数字，返回1表示是数字，返回0表示不是。

参数设计
--------------------------------

**参数的命名要恰当，能帮助调用者理解函数意图**

```c
char *strcpy(char *dest, const char *src);      // 良好的风格
char *strcpy(char *str1, const char *str2);     // 不好的风格
```

**如果函数没有参数，则用void 填充**

```c
float get_value(void); // 良好的风格
float get_value(); // 不良的风格
```

**参数顺序的潜规则**

参数的设计本没有规则，只是前人的代码多了，慢慢出现了一些潜规则。

来源与目的，一般是目的在前，来源在后，如下：
```c
char *strcpy(char *dest, const char *src);
```

**涉及到内存写操作的参数，最好传入内存长度**

```c
char *strcpy(char *dest, const char *src);                  // 不好的设计，有越界风险
size_t strlcpy(char *dst, const char *src, size_t siz);     // 好的设计
```

这里有个问题：为什么上述strlcpy里的长度参数只需要一个，而不是两个，请思考。

```c
ssize_t recv(int sockfd, void *buf, size_t len, int flags); // 好的设计
```

函数实现
--------------------------------

函数实现大体可以分为两类：
* 业务函数
* 接口函数

**业务函数**

业务函数一般是功能逻辑组合的代码，一个业务函数会对应一个特定的功能，这种函数的要求比较低，也没有什么标准。

**接口函数**

接口函数一般有以下特点：公共函数，可重入，提供单一功能

