
> 作者：nicer  
> 微信公众号：好好编程

C风格要素之 排版与格式
==================================

程序的版式并不影响程序功能，但是它影响阅读。

为了使代码清晰、整洁、漂亮，我们需要一些排版技巧。

合理使用空行
------------------------

想象一下一篇很长的文章没有段落，是不是给人感觉这文章没有层次，需要一口气从头读到尾。

那平时我们是怎么表现段落的呢，答案就是段落之间用空行分隔。

类比到写代码，我们可以使用空行来区分不同功能的代码段，可以使层次清晰。

* **函数体之间用空行分隔**

示例：
```
void *memset(void *s, int c, size_t n)
{
    ...
}

void *memcpy(void *dest, const void *src, size_t n)
{
    ...
}
```

* **不同功能的代码块之间用空行分隔**

示例：
```
int window_init(void)
{
    button.id = 1;
    button.width = 50;
    button.height = 100;

    text.id = 2;
    text.data = "hello";
}
```

总之，空行的使用原则是，把不同功能的代码块之间用空行分隔。

合理使用空格
------------------------

空格使用的原则是使操作数与操作符之间的分隔更加清晰。如果已经是非常清晰的语句则没有必要再用空格。

* **二元操作符两边使用空格**

示例
```
int a = 0;

a += b;

a = c + b;

if(a >= 2000)

if(a || b)

```

* **参数之间使用空格** 

示例：
```
void Func1(int x, int y, int z);
```

合理使用括号
------------------------

* **用括号分隔子表达式，不要只靠默认优先级来判断**

示例：
```
if((a && b) || (c && d))
```

* **建议：用括号分隔if/while/for等语句的代码块，哪怕代码只有一行**

示例：
```
if(a > b)
{
    do_something(c, d);
}

for(i=0; i<10; i++)
{
    do_something(c, d);
}
```

想象一个上述例子中的`do_something()`如果不是一个函数而是一个宏定义的话呢？
宏定义可能不止一个语句，如果不加`{}` 是有可能出错的。


* **关于大括号 `{}` 是否换行** 

对于 `{}` 是否换行，程序员界有很大的争议。

换行的优点是对称，不换行的优点是紧凑。

示例：
```
// 大括号不换行
if(a > 0) {             
    ...
}
else {
    ...
}

//大括号换行
if(a > 0)
{
    ...
}
else 
{
    ...
}
```

两种写法各有千秋，选用其中一种即可。

合理使用缩进
------------------------

缩进的作用就是使用代码层级更加清晰。

代码应该使用缩进的风格编写，每一级都正常缩进。缩进可以是tab也可以是4个空格，选用一种，不要两种都用。

示例：
```
if(a > b)
{
    for(i = 0; i < 100; i++)
    {
        ...
    }
}
```

长行拆分
------------------------

代码行太行有可能超过电脑屏幕的边沿，需要来回滚动才能阅读，可以把一行代码拆分成多行方便阅读。

* **代码行最大长度需要有一个限定，一般是80个字符**

示例：
```
if ((very_longer_variable1 >= very_longer_variable12)
        && (very_longer_variable3 <= very_longer_variable14)
        && (very_longer_variable5 <= very_longer_variable16))
{
    do_something();
}
```

